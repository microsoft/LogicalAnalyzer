# Azure Pipelines
# https://aka.ms/yaml

name: OAT_$(SourceBranchName)_$(Date:yyyyMMdd)$(Rev:.r)
trigger:
  batch: true
  branches:
    include:
    - main
  paths:
    include:
    - OAT
    
pr:
  branches:
    include:
    - main
  paths:
    include:
    - Pipelines
    - OAT
    - OAT.Tests
    - OAT.sln

stages:
- stage: Test
  jobs:
  - template: templates/dotnet-test-job.yml
    parameters:
      dotnetVersion: '3.1.x'
      projectPath: 'OAT.Tests/OAT.Tests.csproj'

- stage: SDL
  dependsOn: Test
  jobs:
  - template: templates/sdl-job.yml
    parameters:
      serviceTreeID: '2a6899f5-60b4-432d-8b83-40c0b2dacc0e'

